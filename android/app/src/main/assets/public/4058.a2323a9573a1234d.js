"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[4058],{4058:(O,y,a)=>{a.r(y),a.d(y,{CambiarClavePage:()=>g,createPasswordStrengthValidator:()=>p,passwordMatchValidator:()=>T});var t=a(3953),C=a(177),r=a(4341),v=a(8638),b=a(1125),_=a(5873),f=a(5079),w=a(8880);function P(l,c){1&l&&t.nrm(0,"ion-input-password-toggle",6)}function k(l,c){1&l&&t.nrm(0,"ion-input-password-toggle",6)}function M(l,c){1&l&&(t.j41(0,"ion-button"),t.nrm(1,"ion-spinner",10),t.k0s())}function E(l,c){if(1&l){const h=t.RV6();t.j41(0,"ion-button",11),t.bIt("click",function(){t.eBV(h);const o=t.XpG();return t.Njj(o.cambiarClave())}),t.EFF(1," Cambiar clave "),t.k0s()}if(2&l){const h=t.XpG();t.Y8G("disabled",h.cambiarForm.invalid)}}let g=(()=>{var l;class c{constructor(n){this.nav=n,this.isVerify=!1,this.authService=(0,t.WQX)(b.u),(0,f.a)({arrowBackOutline:_.hGB})}ngOnInit(){this.cambiarForm=new r.gE({password:new r.MJ("",[r.k0.required,r.k0.minLength(12),l=>{const c=l.value;if(!c)return null;const h=/[A-Z]+/.test(c),n=/[a-z]+/.test(c),o=/[0-9]+/.test(c),m=/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]+/.test(c);return h&&n&&o&&m?null:{passwordStrength:!0}}]),password_confirmation:new r.MJ("",[r.k0.required,T("password")])})}cambiarClave(){this.isVerify=!0,this.authService.changePasswd(this.cambiarForm.value).then(n=>{var o,m;1===(null==n||null===(o=n.data)||void 0===o?void 0:o.success)?(this.authService.showToast("Contrase\xf1a cambiada correctamente"),this.authService.navigateByUrl("/auth/login"),this.isVerify=!1,this.cambiarForm.reset()):(this.isVerify=!1,this.authService.showToast(null==n||null===(m=n.data)||void 0===m?void 0:m.message))}).catch(n=>{var o;this.isVerify=!1,this.authService.showToast(null==n||null===(o=n.error)||void 0===o?void 0:o.message)})}onInput(n){this.pass=n.target.value}onInputConfirm(n){this.pass_confirm=n.target.value}goBack(){this.nav.back()}}return(l=c).\u0275fac=function(n){return new(n||l)(t.rXU(w.q9))},l.\u0275cmp=t.VBU({type:l,selectors:[["app-cambiar-clave"]],standalone:!0,features:[t.aNF],decls:14,vars:5,consts:[[3,"fullscreen"],["size","large","name","arrow-back-outline",1,"back",3,"click"],[1,"container"],["src","assets/logo.webp",1,"logo"],[3,"formGroup"],["type","password","label","Ingresa tu nueva contrase\xf1a","label-placement","floating","fill","outline","formControlName","password","placeholder","****************",1,"input",3,"ionInput"],["color","medium","slot","end"],["type","password","formControlName","password_confirmation","label","Confirma tu nueva contrase\xf1a","label-placement","floating","fill","outline","placeholder","****************",1,"input",3,"ionInput"],[1,"Cambiar"],[3,"disabled"],["name","lines-small"],[3,"click","disabled"]],template:function(n,o){1&n&&(t.j41(0,"ion-content",0)(1,"ion-icon",1),t.bIt("click",function(){return o.goBack()}),t.k0s(),t.j41(2,"div",2),t.nrm(3,"ion-img",3),t.j41(4,"form",4)(5,"ion-input",5),t.bIt("ionInput",function(A){return o.onInput(A)}),t.DNE(6,P,1,0,"ion-input-password-toggle",6),t.k0s(),t.j41(7,"ion-input",7),t.bIt("ionInput",function(A){return o.onInputConfirm(A)}),t.DNE(8,k,1,0,"ion-input-password-toggle",6),t.k0s()(),t.j41(9,"p"),t.EFF(10,"Cree una contrase\xf1a segura"),t.k0s(),t.j41(11,"div",8),t.DNE(12,M,2,0,"ion-button")(13,E,2,1,"ion-button",9),t.k0s()()()),2&n&&(t.Y8G("fullscreen",!0),t.R7$(4),t.Y8G("formGroup",o.cambiarForm),t.R7$(2),t.vxM(o.pass?6:-1),t.R7$(2),t.vxM(o.pass_confirm?8:-1),t.R7$(4),t.vxM(o.isVerify?12:13))},dependencies:[v.iq,v.w2,v.Wv,r.X1,r.qT,r.BC,r.cb,r.j4,r.JD,v.KW,v.$w,v.Jm,v.W9,C.MD,r.YN],styles:["ion-content[_ngcontent-%COMP%]{padding:0 20px}.container[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center;height:100%;transform:translateY(-20px);width:100%}.logo[_ngcontent-%COMP%]{transform:translateY(-10px);width:300px;height:300px}form[_ngcontent-%COMP%]{width:80%;text-align:left}.input[_ngcontent-%COMP%]{margin-top:1.5rem}ion-button[_ngcontent-%COMP%]{--border-width: 1px;--border-radius: 10px;--border-style: solid;--border-color: #b9b9b956;--box-shadow: 0 4px 8px 0 rgba(0, 0, 0, .25);--ripple-color: #7e7c7c;text-transform:none;width:100%;height:3rem;font-size:1rem;font-weight:400;margin-top:1.5rem}.Cambiar[_ngcontent-%COMP%]{display:flex;justify-content:center;align-items:center;width:80%;transform:translateY(-20px)}.back[_ngcontent-%COMP%]{padding-top:6%;margin-left:5%}"]}),c})();function T(l){return c=>{var h;const n=null===(h=c.parent)||void 0===h?void 0:h.get(l);return n&&c.value!==n.value?{passwordMismatch:!0}:null}}function p(){return l=>{const c=l.value;if(!c)return null;const h=/[A-Z]+/.test(c),n=/[a-z]+/.test(c),o=/[0-9]+/.test(c),m=/[!@#$%^&*()_+\-=\[\]{};':"\\|,.<>\/?]+/.test(c);return h&&n&&o&&m?null:{passwordStrength:!0}}}},1125:(O,y,a)=>{a.d(y,{u:()=>T});var t=a(467),C=a(5149),r=a(8458),v=a(4558),b=a(3953),_=a(6394),f=a(5083);const w=(0,f.F3)("Preferences",{web:()=>a.e(2924).then(a.bind(a,2924)).then(p=>new p.PreferencesWeb)});var P=a(8638),k=a(5079),M=a(5873),E=a(4412),g=a(7669);let T=(()=>{var p,l=new WeakMap,c=new WeakMap,h=new WeakMap,n=new WeakMap,o=new WeakMap;class m{constructor(){(0,C.A)(this,l,void 0),(0,C.A)(this,c,void 0),(0,C.A)(this,h,void 0),(0,C.A)(this,n,void 0),(0,C.A)(this,o,void 0),this.emailShared=null,(0,v.A)(l,this,(0,b.WQX)(_.Ix)),(0,v.A)(c,this,(0,b.WQX)(P.hG)),(0,v.A)(h,this,(0,b.WQX)(P.K_)),(0,v.A)(n,this,[]),(0,v.A)(o,this,new E.t(null)),(0,k.a)({alertCircle:M.nVl})}setEmail(e){this.emailShared=e}getEmail(){return this.emailShared}get token(){return(0,r.A)(o,this).asObservable()}actualizarToken(e){(0,r.A)(o,this).next(e)}actualizarTokenEnLocal(e){return(0,t.A)(function*(){yield w.set({key:"token",value:e})})()}establecerToken(e){this.actualizarToken(e),this.actualizarTokenEnLocal(e)}obtenerToken(){return(0,t.A)(function*(){const e=yield w.get({key:"token"});if(!e)throw new Error("Token no encontrado");return e.value})()}eliminarToken(){var e=this;return(0,t.A)(function*(){e.actualizarToken(null),yield w.remove({key:"token"})})()}register(e){var i=this;return(0,t.A)(function*(){const d={url:g.c.serverUrl+"auth/register",headers:{"Content-Type":"application/json"},data:JSON.stringify(e)};try{var u;const s=yield f.pX.post(d);return i.establecerToken(null==s||null===(u=s.data)||void 0===u?void 0:u.token),s}catch(s){throw s}})()}login(e){var i=this;return(0,t.A)(function*(){const d={url:g.c.serverUrl+"auth/login",headers:{"Content-Type":"application/json"},data:JSON.stringify(e)};try{var u;const s=yield f.pX.post(d);return i.establecerToken(null==s||null===(u=s.data)||void 0===u?void 0:u.token),s}catch(s){throw s}})()}logout(){var e=this;return(0,t.A)(function*(){const i=yield e.obtenerToken(),d={url:g.c.serverUrl+"auth/logout",headers:{Authorization:`Bearer ${i}`}};try{return yield f.pX.get(d)}catch(u){throw u}})()}perfil(){var e=this;return(0,t.A)(function*(){const i=yield e.obtenerToken(),d={url:g.c.serverUrl+"auth/profile",headers:{Authorization:`Bearer ${i}`}};try{return yield f.pX.get(d)}catch(u){throw u}})()}showAlert(e){var i=this;return(0,t.A)(function*(){yield(yield(0,r.A)(c,i).create({header:"Error de Autenticacion",message:e,buttons:["OK"]})).present()})()}navigateByUrl(e){(0,r.A)(l,this).navigateByUrl(e,{replaceUrl:!0})}showToast(e){var i=this;return(0,t.A)(function*(){const d=yield(0,r.A)(h,i).create({message:e,position:"top",positionAnchor:"header",duration:3e3,icon:"alert-circle",color:"primary"});(0,r.A)(n,i).push(d),1===(0,r.A)(n,i).length&&i.showNextToast()})()}showNextToast(){var e=this;return(0,t.A)(function*(){if((0,r.A)(n,e).length>0){const i=(0,r.A)(n,e)[0];yield i.present(),i.onDidDismiss().then(()=>{(0,r.A)(n,e).shift(),e.showNextToast()})}})()}verificarEmail(e){return(0,t.A)(function*(){const i={url:g.c.serverUrl+"auth/send_reset_password_code",headers:{"Content-Type":"application/json"},data:JSON.stringify(e)};try{return yield f.pX.post(i)}catch(d){throw d}})()}verifyCodeChangePasswd(e){var i=this;return(0,t.A)(function*(){const d={url:g.c.serverUrl+"auth/verify_reset_password_code",headers:{"Content-Type":"application/json"},data:JSON.stringify(e)};try{var u;const s=yield f.pX.post(d);return i.establecerToken(null==s||null===(u=s.data)||void 0===u?void 0:u.token),s}catch(s){throw s}})()}changePasswd(e){var i=this;return(0,t.A)(function*(){const d=yield i.obtenerToken(),u={url:g.c.serverUrl+"auth/reset_password",headers:{"Content-Type":"application/json",Authorization:`Bearer ${d}`},data:JSON.stringify(e)};try{return yield f.pX.put(u)}catch(s){throw s}})()}}return(p=m).\u0275fac=function(e){return new(e||p)},p.\u0275prov=b.jDH({token:p,factory:p.\u0275fac,providedIn:"root"}),m})()},7669:(O,y,a)=>{a.d(y,{c:()=>t});const t={production:!0,serverUrl:"https://valiant-luck-production.up.railway.app/api/"}}}]);